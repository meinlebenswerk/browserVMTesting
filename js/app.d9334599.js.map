{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?881d","webpack:///./src/lib/vmbrowserModule.js","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/App.vue?c650"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","_v","_m","staticClass","_l","lut","_s","test","description","_e","staticRenderFns","vm","contextifiedSandboxes","createIFrame","iframe","document","createElement","style","display","createIFrameWithContext","sandbox","body","appendChild","contentWindow","runCodeInNewContext","code","eval","removeChild","runCodeInContext","context","Error","Script","runInContext","runInNewContext","runInThisContext","createContext","isContext","indexOf","runInDebugContext","createScript","cookies","localStorage","getItem","results","mounted","initializeTests","console","log","browserifyResults","methods","cookie","setItem","runTest","testVMBrowserify","allTests","map","testVMBrowser","script","component","Vue","config","productionTip","render","h","App","$mount"],"mappings":"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","file":"js/app.d9334599.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/browserVMTesting/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('h1',[_vm._v(\"NodeJS VM Browser Implementation tester\")]),_vm._m(0),_c('div',{staticClass:\"content-wrapper\"},[_c('div',{staticClass:\"demo-wrapper\"},_vm._l((_vm.results),function(lut){return _c('div',{staticClass:\"demo card\"},[_c('h2',[_vm._v(_vm._s(lut.name))]),_vm._m(1,true),_vm._l((lut.tests),function(test){return _c('div',{staticClass:\"test\"},[_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(test.name))]),(test.result)?_c('div',{staticClass:\"result\"},[_vm._v(\"✅\"),_c('div',{staticClass:\"description card\"},[_c('b',[_vm._v(\"leak found\")]),_c('br'),_vm._v(_vm._s(test.description))])]):_vm._e(),(!test.result)?_c('div',{staticClass:\"result\"},[_vm._v(\"❎\"),_c('div',{staticClass:\"description card\"},[_c('b',[_vm._v(\"no leak found\")]),_c('br'),_vm._v(_vm._s(test.description)+\" \")])]):_vm._e()])})],2)}),0)]),_c('div',{staticClass:\"hidden\",attrs:{\"id\":\"secret\"}},[_vm._v(\"cake\")])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',{staticClass:\"text-wrapper text\"},[_vm._v(\"A small project, built as part of my engineering practice, to outline potential shortcomings of web-based polyfills for NodeJS's vm. The context here is, we were developing a solution for running machine-learning algorithms from a web-based no-code editor. But for optimal usability, this requires some sort of real-time feedback, which I figured is best pushed to the user's browser. (Since the server we are working on will likely die, if you hit it with too many clients at once) There's just a slight problem, the backend's code is purely written in Python, and well, web-browsers don't really like that language. But directly transpiling the Python code to JavaScript and sending that to the clients doesn't seem like a great idea either... Which is why I developed a solution which first transpiles the Python to LUA, and then, using fengari runs that in the browser. While that's not ultra-secure either, it should help avoid some mistakes :) During some research I came accross NodeJS's VM, which provides a separate context for executing JS-Code.\"),_c('br'),_c('b',[_vm._v(\"Note: THIS IS NOT INTENDED AS A SECURITY MECHANISM\")]),_vm._v(\" it's fairly easy to break, as shown by \"),_c('a',{attrs:{\"href\":\"https://gist.github.com/jcreedcmu\"}},[_vm._v(\"jcreedcmu\")]),_vm._v(\" \"),_c('a',{attrs:{\"href\":\"https://gist.github.com/jcreedcmu/4f6e6d4a649405a9c86bb076905696af\"}},[_vm._v(\"here\")]),_vm._v(\" this can fairly easily be circumvented. But anyways, there are browser-implementations of it (They all use an iframe in some sort of way), so I thought, let's test them, maybe they could be useful...\"),_c('br'),_vm._v(\"The thought here was - browsers implement their fair share of security mechanisms, maybe it works better here? But as you can see below (Live Demo, by the way), they're also not that great...\"),_c('br'),_vm._v(\"Do note, these exploits are fairly simple, so if something shows up as \\\"secure\\\", that doesn't mean you can trust it :)\")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"name\"},[_vm._v(\"Test name\")]),_c('div',{staticClass:\"result\"},[_vm._v(\"result\")])])}]\n\nexport { render, staticRenderFns }","/* eslint-disable */\r\n\r\nvar vm = {};\r\nvar contextifiedSandboxes = [];\r\n\r\nfunction createIFrame() {\r\n  var iframe = document.createElement('iframe');\r\n  iframe.style.display = 'none';\r\n  return iframe;\r\n}\r\n\r\nfunction createIFrameWithContext(sandbox) {\r\n  var iframe = createIFrame();\r\n  var key;\r\n  document.body.appendChild(iframe);\r\n  if (sandbox) {\r\n    for (key in sandbox) {\r\n      if (sandbox.hasOwnProperty(key)) {\r\n        iframe.contentWindow[key] = sandbox[key];\r\n      }\r\n    }\r\n    contextifiedSandboxes.push(sandbox);\r\n  }\r\n  return iframe;\r\n}\r\n\r\nfunction runCodeInNewContext(code, sandbox) {\r\n  var iframe = createIFrameWithContext(sandbox);\r\n  var result = iframe.contentWindow.eval(code);\r\n  document.body.removeChild(iframe);\r\n  return result;\r\n}\r\n\r\nfunction runCodeInContext(code, context) {\r\n  if (!context) {\r\n    throw new Error('Context cannot be undefined');\r\n  }\r\n  return context.eval(code);\r\n}\r\n\r\nfunction Script(code) {\r\n  this.code = code;\r\n}\r\n\r\nScript.prototype.runInContext = function (context) {\r\n  return runCodeInContext(this.code, context);\r\n};\r\n\r\nScript.prototype.runInNewContext = function (sandbox) {\r\n  return runCodeInNewContext(this.code, sandbox);\r\n};\r\n\r\nScript.prototype.runInThisContext = function () {\r\n  return runCodeInContext(this.code, window);\r\n};\r\n\r\nvm.Script = Script;\r\n\r\nvm.createContext = function (sandbox) {\r\n  return createIFrameWithContext(sandbox).contentWindow;\r\n};\r\n\r\nvm.isContext = function (sandbox) {\r\n  return contextifiedSandboxes.indexOf(sandbox) !== -1;\r\n};\r\n\r\nvm.runInContext = function (code, context) {\r\n  return runCodeInContext(code, context);\r\n};\r\n\r\nvm.runInDebugContext = function () {\r\n  throw new Error('vm.runInDebugContext(code) does not work in browsers');\r\n};\r\n\r\nvm.runInNewContext = function (code, sandbox) {\r\n  return runCodeInNewContext(code, sandbox);\r\n};\r\n\r\nvm.runInThisContext = function (code) {\r\n  return runCodeInContext(code, window);\r\n};\r\n\r\nvm.createScript = function (code) {\r\n  return new vm.Script(code);\r\n};\r\n\r\n\r\nexport default vm;\r\n","<template lang=\"pug\">\n#app\n  h1 NodeJS VM Browser Implementation tester\n  p.text-wrapper.text\n    .\n      A small project, built as part of my engineering practice, to outline potential shortcomings of web-based polyfills for NodeJS's vm.\n      The context here is, we were developing a solution for running machine-learning algorithms from a web-based no-code editor.\n      But for optimal usability, this requires some sort of real-time feedback, which I figured is best pushed to the user's browser.\n      (Since the server we are working on will likely die, if you hit it with too many clients at once)\n      There's just a slight problem, the backend's code is purely written in Python, and well, web-browsers don't really like that language.\n      But directly transpiling the Python code to JavaScript and sending that to the clients doesn't seem like a great idea either...\n      Which is why I developed a solution which first transpiles the Python to LUA, and then, using fengari runs that in the browser.\n      While that's not ultra-secure either, it should help avoid some mistakes :)\n      During some research I came accross NodeJS's VM, which provides a separate context for executing JS-Code.\n    br\n    b Note: THIS IS NOT INTENDED AS A SECURITY MECHANISM\n    .\n      &nbsp;it's fairly easy to break, as shown by \n    a(href=\"https://gist.github.com/jcreedcmu\") jcreedcmu\n    .\n      &nbsp;\n    a(href=\"https://gist.github.com/jcreedcmu/4f6e6d4a649405a9c86bb076905696af\") here\n    .\n      &nbsp;this can fairly easily be circumvented.\n      But anyways, there are browser-implementations of it (They all use an iframe in some sort of way), so I thought, let's test them, maybe they could be useful...\n    br\n    .\n      The thought here was - browsers implement their fair share of security mechanisms, maybe it works better here?\n      But as you can see below (Live Demo, by the way), they're also not that great...\n    br\n    .\n      Do note, these exploits are fairly simple, so if something shows up as \"secure\", that doesn't mean you can trust it :)\n  .content-wrapper\n    .demo-wrapper\n      .demo.card(v-for=\"lut of results\")\n        h2 {{ lut.name }}\n        .header\n          .name Test name\n          .result result\n        .test(v-for=\"test of lut.tests\")\n          .name {{ test.name }}\n          .result(v-if=\"test.result\") ✅\n            .description.card \n              b leak found\n              br\n              .\n                {{ test.description }}\n          .result(v-if=\"!test.result\") ❎\n            .description.card\n              b no leak found\n              br\n              .\n                {{ test.description }}\n          \n  #secret.hidden cake\n</template>\n\n<script>\n\nimport VMBrowserify from 'vm'\nimport VMBrowser from '@/lib/vmbrowserModule'\n\nconst wrapFunction = func => `(${func.toString()})()`\n\nconst checkCookieLeak = () => {\n  const cookies = Object.fromEntries(document.cookie.split('; ').map(v=>v.split('=').map(decodeURIComponent)));\n  return cookies['secret'] === 'cake';\n}\n\nconst checkLocalStorageLeak = () => {\n  return window.localStorage.getItem('secret') === 'cake';\n}\n\nconst checkHTMLLeak = () => {\n  const htmlSecret = document.getElementById('secret');\n  return htmlSecret?.innerText === 'cake';\n}\n\n\nconst allTests = [\n  {\n    name: 'cookie',\n    description: 'Checks if a cookie set via document.cookie can be accessed from inside the VM',\n    f: checkCookieLeak\n  }, {\n    name: 'localStorage',\n    description: 'Checks if data written to localStorage is accessible from inside the VM',\n    f: checkLocalStorageLeak\n  }, {\n    name: 'html',\n    description: 'Checks if the VM has access to the HTMl-Document',\n    f: checkHTMLLeak\n  }]\n\nexport default {\n  name: 'App',\n\n  data() {\n    return {\n      results: [],\n    }\n  },\n\n  mounted(){\n    this.initializeTests();\n    this.results.push({name: 'vm-browserify', tests: this.testVMBrowserify()});\n    this.results.push({name: 'vm-browser', tests: this.testVMBrowser()});\n    console.log(this.browserifyResults)\n  },\n\n  methods: {\n    initializeTests(){\n      // Set a cookie\n      document.cookie = 'secret=cake; path=/'\n      // set some local storage\n      window.localStorage.setItem('secret', 'cake');\n    },\n\n    runTest(test, runner) {\n      const { name, description, f } = test;\n      const result = runner(f);\n      return { name, description, result };\n    },\n\n    testVMBrowserify() {\n      const testRunner = (f) => VMBrowserify.runInNewContext(wrapFunction(f), {});\n      return allTests.map(test => this.runTest(test, testRunner));\n    },\n\n    testVMBrowser() {\n      const sandbox = {}\n      const context = VMBrowser.createContext(sandbox);\n      const testRunner = (f) => {\n        const script = new VMBrowser.Script(wrapFunction(f));\n        return script.runInContext(context);\n      }\n      return allTests.map(test => this.runTest(test, testRunner));\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n@import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,900;1,300&display=swap');\n\nbody {\n  margin: 0;\n  box-sizing: border-box;\n}\n\n#app {\n  font-family: 'Montserrat', sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n\n  background: #fefefe;\n  color: #2c3e50;\n\n  display: flex;\n  flex-direction: column;\n  width: 100vw;\n  height: 100vh;\n}\n\nh1 {\n  font-weight: 800;\n  font-size: 2.4rem;\n}\n\nh2 {\n  font-weight: 800;\n}\n\n.text-wrapper {\n  width: 90%;\n  max-width: 700px;\n  margin: 0 auto;\n  text-align: justify;\n}\n\n.text {\n  font-size: 1.15rem;\n  \n  &::after {\n    content: \" \";\n  }\n\n  &.bold {\n    font-weight: 600;\n  }\n\n  a {\n    display: inline-block;\n  }\n}\n\n.card {\n  background: #F9F9F9;\n  margin: 0 4rem;\n\n  border-radius: 10px;\n  box-shadow: 0px 0px 32px 8px rgba($color: #000000, $alpha: 0.1);\n}\n\n.content-wrapper {\n  flex: 1 1 0;\n  display: flex;\n  flex-direction: column;\n}\n\n.demo-wrapper {\n  flex: 0 1 0;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  margin: auto;\n  width: 100%;\n\n  padding: 2rem 0;\n\n  .demo {\n    position: relative;\n    width: 40%;\n    max-width: 400px;\n    background: #F9F9F9;\n    margin: 0 4rem;\n\n    border-radius: 10px;\n    box-shadow: 0px 0px 32px 8px rgba($color: #000000, $alpha: 0.1);\n\n    h2 {\n      margin: 2rem 0;\n    }\n\n    .header,\n    .test {\n      display: grid;\n      grid-template-columns: 5fr 5fr;\n      \n      .name {\n        font-weight: 800;\n      }\n    }\n\n    .test {\n      margin: 2rem 0;\n    }\n\n    .result {\n      position: relative;\n      cursor: default;\n    }\n\n\n    .description {\n      z-index: 10;\n      opacity: 0;\n      display: block;\n      position: absolute;\n      top: -22px;\n      right: 30%;\n      margin: 0;\n      transform: translateX(100%);\n      width: 200px;\n\n      background: #F9F9F9;\n      padding: 1rem;\n\n      transition: opacity 100ms ease-in-out;\n\n      &::after {\n       content: \" \";\n       display: block;\n       width: 32px;\n       height: 32px;\n       position: absolute;\n       left: -8px;\n       top: 16px;\n\n       z-index: -1;\n\n       transform: rotateZ(45deg);\n\n       background: #F9F9F9;\n     }\n    }\n\n    .result:hover > .description {\n      opacity: 1;\n    }\n\n\n\n    .header {\n      border-bottom: 1px solid rgba($color: #000000, $alpha: 0.1);\n      margin: 1rem 0 2rem 0;\n    }\n  }\n}\n\n\n.hidden {\n  display: none;\n}\n\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=57bcdca4&lang=pug&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}